## 고객 관련 도메인 문서

### 구현 스펙

- **검색 파라미터**: URL `name`으로 검색어 관리, 입력값은 `defaultValue`만 사용하여 IME 문제 방지
- **정렬 파라미터**: URL `sort`로 관리 (`asc` | `desc`), 기본값은 `desc`
- **디바운스**: 검색어는 300ms 디바운스 후 쿼리 실행
- **상세 보기**: 행 클릭 시 우측 시트로 구매 내역 로드 (URL로 자동 오픈은 현재 미지원)

---

### URL 파라미터 설계 (UI 상태)

- `name`: 고객 이름 검색어. 주소창 공유 시 동일한 검색 상태를 재현할 수 있습니다.
- `sort`: 총 구매 금액 정렬 방향. `asc` 또는 `desc` (기본값 `desc`).

예시

```text
/customers?name=kim&sort=asc
```

### 입력값 처리와 IME 이슈

입력값을 URL에 바로 바인딩해 `value`로 제어하면, 다음 문제가 발생할 수 있습니다

1. 입력값 변경
2. URL 인코딩 저장
3. 디코딩 재반영
4. IME(한글 등) 조합 상태가 풀림

해결 전략

- `Input`은 비제어 컴포넌트로 두고 `defaultValue`만 URL 초기값으로 설정합니다.
- 사용자가 입력할 때마다 `setSearchParams`로 URL을 갱신합니다.
- 실제 쿼리는 디바운스된 값으로 수행해 불필요한 네트워크 호출을 줄입니다.

### 목록/정렬/검색 동작 흐름

1. 사용자가 검색어를 입력하면 URL `name`이 갱신됩니다.
2. 300ms 후 디바운스된 값으로 고객 목록 쿼리를 수행합니다.
3. 정렬 헤더 클릭 시 URL `sort`가 토글되며, 이후 쿼리에 반영됩니다.
4. 필요한 경우 화면단에서 소문자 비교로 추가 필터링을 수행합니다.

### 고객 상세 구매 내역 시트

- 행을 클릭하면 우측에서 시트가 열리며, 해당 고객의 구매 내역을 별도 쿼리로 로드합니다.
- 구현 위치
  - 트리거: `CustomersPage.tsx` (row click)
  - 시트 UI/데이터: `CustomerPurchasesSheet.tsx`
  - 오버레이 훅: `useCustomerPurchasesSheet.tsx`

현재 제약

- 들어오자마자 특정 고객의 시트를 자동으로 여는 기능은 없습니다.
  - 해당 기능을 구현하기 위해서는 주문 내역을 가져오는 API에 고객 정보가 있어야 가능하다 생각했습니다.
  - 현재 과제용 서버 스펙상 무한 스크롤/페이지네이션 기능이 없어, 데이터 가져와서 열어주는 형식으로 구현은 가능하나, 해당 방식은 너무 임시적인 로직이 많다고 판단하여 서버 API를 개선하는 것이 더 맞는 방식이라 생각합니다.
